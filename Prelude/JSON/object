let JSON = ./JSON

let object
    : List { mapKey : Text, mapValue : JSON } → JSON
    =   λ(x : List { mapKey : Text, mapValue : JSON })
      → λ(JSON : Type)
      → λ(string : Text → JSON)
      → λ(number : Double → JSON)
      → λ(object : List { mapKey : Text, mapValue : JSON } → JSON)
      → λ(array : List JSON → JSON)
      → λ(bool : Bool → JSON)
      → λ(null : JSON)
      → object
        ( ../List/map
          { mapKey : Text, mapValue : JSON@1 }
          { mapKey : Text, mapValue : JSON }
          (   λ(kv : { mapKey : Text, mapValue : JSON@1 })
            → { mapKey =
                  kv.mapKey
              , mapValue =
                  kv.mapValue JSON string number object array bool null
              }
          )
          x
        )

in  object
